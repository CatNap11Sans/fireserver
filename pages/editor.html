<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fire Server - Editor</title>
    <link rel="stylesheet" href="../css/editor.css">
    <!-- Monaco Editor -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/editor/editor.main.min.css">
</head>
<body>
    <div class="editor-container">
        <!-- üüß Sidebar -->
        <div class="sidebar">
            <button class="sidebar-btn" id="toggle-sidebar" title="Fechar barra lateral">
                <span>‚ò∞</span>
            </button>
            <button class="sidebar-btn" id="ai-assistant" title="Conversar com IA">
                <span>ü§ñ</span>
            </button>
            <button class="sidebar-btn" id="discord-btn" title="Discord">
                <span>üí¨</span>
            </button>
            <button class="sidebar-btn" id="back-home" title="Voltar para menu">
                <span>üè†</span>
            </button>
        </div>

        <!-- üü¶ Toolbar -->
        <div class="toolbar">
            <button class="toolbar-btn" id="select-mode">
                <span>üëÜ</span> Selecionar
            </button>
            <button class="toolbar-btn" id="move-mode">
                <span>‚úã</span> Mover
            </button>
            <button class="toolbar-btn" id="scale-mode">
                <span>‚ÜîÔ∏è</span> Escalonar
            </button>
            <div style="flex: 1;"></div>
            <button class="toolbar-btn success" id="test-btn">
                <span>‚ñ∂Ô∏è</span> Testar
            </button>
            <button class="toolbar-btn danger" id="stop-btn">
                <span>‚èπÔ∏è</span> Parar
            </button>
            <button class="toolbar-btn" id="config-btn">
                <span>‚öôÔ∏è</span> Configurar
            </button>
            <button class="toolbar-btn primary" id="save-btn">
                <span>üíæ</span> Salvar
            </button>
        </div>

        <!-- üü© Tabs -->
        <div class="tabs" id="tabs-container">
            <div class="tab active" data-tab="preview">
                <span>üìÑ</span> Preview
            </div>
        </div>

        <!-- üü® Preview -->
        <div class="preview" id="preview-area">
            <div class="preview-loading" id="preview-loading">Carregando preview...</div>
            <iframe class="preview-frame" id="preview-frame" style="display: none;"></iframe>
        </div>

        <!-- ‚¨ú Output -->
        <div class="output" id="output-console">
            <div class="output-line info">üî• Fire Server Editor v1.0</div>
            <div class="output-line">Console pronto. Execute scripts para ver resultados.</div>
        </div>

        <!-- üü™ Explorer -->
        <div class="explorer">
            <div class="explorer-header">
                <span>üåç Workspace</span>
                <button class="toolbar-btn" id="add-root" style="padding: 4px 8px; font-size: 12px;">
                    <span>+</span>
                </button>
            </div>
            <div class="explorer-tree" id="explorer-tree">
                <div class="tree-item" data-type="Site" data-id="site-root">
                    <span class="tree-item-icon">üìù</span>
                    <span class="tree-item-name">Site</span>
                    <span class="tree-item-add">üîµ</span>
                </div>
            </div>
        </div>

        <!-- ‚¨õ Properties -->
        <div class="properties" id="properties-panel">
            <div class="properties-header">Propriedades</div>
            <div id="properties-content">
                <p style="color: #999; font-size: 13px;">Selecione um objeto no Explorer para ver suas propriedades.</p>
            </div>
        </div>
    </div>

    <!-- AI Assistant Panel -->
    <div class="ai-panel" id="ai-panel">
        <div class="ai-header">
            <h3>ü§ñ Assistente IA</h3>
            <button class="modal-close" id="close-ai">&times;</button>
        </div>
        <div class="ai-messages" id="ai-messages">
            <div class="ai-message assistant">
                Ol√°! Sou seu assistente Fire Server. Posso ajudar com:
                <ul>
                    <li>Explicar erros no c√≥digo</li>
                    <li>Sugerir corre√ß√µes</li>
                    <li>Traduzir ideias em DSL ou Lua</li>
                </ul>
                Como posso ajudar?
            </div>
        </div>
        <div class="ai-input-area">
            <textarea class="ai-input" id="ai-input" placeholder="Digite sua pergunta..."></textarea>
            <button class="toolbar-btn primary" id="ai-send" style="margin-top: 10px; width: 100%;">
                Enviar
            </button>
        </div>
    </div>

    <!-- Config Modal -->
    <div class="modal" id="config-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è Configura√ß√µes do Site</h3>
                <button class="modal-close" id="close-config">&times;</button>
            </div>
            <div class="property-group">
                <label class="property-label">T√≠tulo do Site</label>
                <input type="text" class="property-input" id="site-title" value="Meu Site">
            </div>
            <div class="property-group">
                <label class="property-label">Descri√ß√£o (SEO)</label>
                <textarea class="property-input" id="site-description" rows="3">Descri√ß√£o do meu site</textarea>
            </div>
            <div class="property-group">
                <label class="property-label">Imagem OG (URL)</label>
                <input type="text" class="property-input" id="site-og-image" placeholder="https://...">
            </div>
            <div class="property-group">
                <label class="property-label">Username</label>
                <input type="text" class="property-input" id="site-username" placeholder="username-0000">
            </div>
            <button class="toolbar-btn primary" style="width: 100%; margin-top: 10px;">
                Salvar Configura√ß√µes
            </button>
        </div>
    </div>

    <!-- Monaco Editor CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
    
    <!-- Fengari (Lua VM em JS) -->
    <script src="https://cdn.jsdelivr.net/npm/fengari-web@0.1.4/dist/fengari-web.js"></script>
    
    <!-- Scripts do projeto -->
    <script src="../js/config.js"></script>
    <script src="../js/workspace.js"></script>
    <script src="../js/lua-api.js"></script>
    <script src="../js/dsl-parser.js"></script>
    <script src="../js/editor.js"></script>
    
    <script>
        // Inicializar Monaco Editor
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs' } });
        
        require(['vs/editor/editor.main'], function() {
            window.monacoEditor = monaco.editor.create(document.getElementById('preview-area'), {
                value: '-- Fire Server Lua Script\n-- Use a API workspace para criar elementos\n\nlocal text = Create.Text(workspace.Site.Page1)\ntext.Text = "Ol√°, Fire Server!"\ntext.Color = Color.RGB(255, 107, 53)\n',
                language: 'lua',
                theme: 'vs-dark',
                automaticLayout: true,
                minimap: { enabled: false },
                fontSize: 14,
                lineNumbers: 'on',
                scrollBeyondLastLine: false,
                wordWrap: 'on'
            });
            
            // Ocultar loading
            document.getElementById('preview-loading').style.display = 'none';
        });
    </script>
</body>
</html>
